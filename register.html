<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge" />
        <meta name="viewport" content="width=device-width, initial-scale=1.0" />
        <!-- reset css -->
        <link rel="stylesheet" href="./assets/css/reset.css" />

        <!-- font awesome cdn -->
        <link
            rel="stylesheet"
            href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.3.0/css/all.min.css"
            integrity="sha512-SzlrxWUlpfuzQ+pcUCosxcglQRNAq/DZjVsC0lE40xsADsfeQoEypE+enwcOiGjk/bSuGGKHEyjSoQ1zVisanQ=="
            crossorigin="anonymous"
            referrerpolicy="no-referrer"
        />

        <!-- font gg -->
        <link rel="preconnect" href="https://fonts.googleapis.com" />
        <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
        <link
            href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;1,300;1,400&display=swap"
            rel="stylesheet"
        />

        <link rel="icon" href="https://source.unsplash.com/random" type="image/x-icon" />
        <!-- style css -->
        <link rel="stylesheet" href="./assets/css/style.css" />
        <title>Form Validation - Register</title>
    </head>
    <body>
        <form autocomplete="off" action="" class="form form_register">
            <h3>Register</h3>
            <div class="label">
                <input required placeholder=" " type="text" name="Name" id="Name" />
                <label for="Name">Full name</label>
                <i class="fa-regular fa-user"></i>
            </div>
            <div class="label">
                <input required placeholder=" " type="email" name="" id="email" />
                <label for="email">Email</label>
                <i class="fa-regular fa-envelope"></i>
            </div>
            <div class="label">
                <input required placeholder=" " type="password" name="password" id="password" />
                <label for="password">Password</label>
                <!-- <i class="fa-solid fa-lock"></i> -->
                <i class="fa-solid fa-eye-slash"></i>
                <!-- <i class="fa-regular fa-eye"></i> -->
            </div>
            <div class="label">
                <input required placeholder=" " type="password" name="Confirm_password" id="Confirm_password" />
                <label for="Confirm_password">Confirm password</label>
                <!-- <i class="fa-solid fa-lock"></i> -->
                <i class="fa-solid fa-eye-slash"></i>
                <!-- <i class="fa-regular fa-eye active"></i> -->
            </div>
            <div class="btn btn_register">Register</div>
            <p class="register">Already have an account? <a href="./index.html" id="Login">Login</a></p>
        </form>
        <script>
            window.onload = function () {
                let listUser = [];
                let user = {};
                let id = 1;
                let btn_register = document.querySelector(".btn.btn_register");
                btn_register.addEventListener("click", () => {
                    listUser = JSON.parse(localStorage.getItem("Users")) || [];
                    let fullName = document.querySelector("#Name").value;
                    let email = document.querySelector("#email").value;
                    let password = document.querySelector("#password").value;
                    let cf_password = document.querySelector("#Confirm_password").value;
                    if (render.invalid(fullName, email, password, cf_password, 0)) {
                        for (var item = 0; item < listUser.length; item++) {
                            if (email === listUser[item].email) {
                                render.fail_register(btn_register);
                                let input = document.querySelector(".label:has(>#email)");
                                render.timeout_error(input);
                                console.log("Email already in use");
                                console.log("Register fail");
                                return false;
                            } else {
                                // console.log("email valid");
                            }
                        }
                        user.id = id;
                        user.fullName = fullName;
                        user.email = email;
                        user.password = password;
                        listUser.push(user);
                        localStorage.setItem("Users", JSON.stringify(listUser));
                        id++;
                        user = {};
                        console.log("Register successfully");
                        fullName = document.querySelector("#Name").value = "";
                        email = document.querySelector("#email").value = "";
                        password = document.querySelector("#password").value = "";
                        cf_password = document.querySelector("#Confirm_password").value = "";
                    } else {
                        render.fail_register(btn_register);
                        console.log("Register fail");
                    }
                });
                render.toogle_hide_password();
            };
        </script>
        <script src="./assets/js/app.js"></script>
    </body>
</html>
